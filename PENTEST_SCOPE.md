# KeyHub Central — Penetration Testing Scope of Work
**Date:** February 23, 2026
**Version:** 1.0
**Prepared by:** KeyHub Central

---

## 1. Overview

KeyHub Central is a Progressive Web App (PWA) managing three interconnected businesses under one platform:

| Business | Purpose |
|----------|---------|
| **Keynote Digital (KD)** | Lead generation and marketing subscriptions for external contractors |
| **Key Trade Solutions (KTS)** | 1099 contractor network — installers, sales reps, PMs, service techs |
| **Key Renovations (KR)** | D2C home renovation sales and project management |

The platform handles sensitive business data including contractor personally identifiable information (PII), W-9 tax documents, insurance certificates, financial records, job details, and homeowner contact information.

---

## 2. Tech Stack

| Layer | Technology |
|-------|------------|
| Frontend | Next.js 14 (App Router, PWA) |
| Hosting | Vercel |
| Database | Firebase Firestore |
| Auth | Firebase Authentication |
| File Storage | Firebase Storage + Google Drive API |
| Backend | Firebase Cloud Functions |
| SMS | Twilio |
| Voice | VAPI |
| APIs | Google Calendar API, Gmail API |

---

## 3. Scope

### 3.1 In Scope

| Target | Details |
|--------|---------|
| **Production app** | `https://keyhubcentral.com` (and any `*.vercel.app` preview URLs) |
| **All authenticated routes** | `/dashboard`, `/kts`, `/kr`, `/kd`, `/financials`, `/admin` |
| **Public routes** | `/login`, `/signup`, `/portal`, `/legal/sms-terms`, lead capture forms |
| **Firebase Firestore** | Security rules validation, direct SDK/REST access attempts |
| **Firebase Storage** | Access control on contractor documents, job photos |
| **Firebase Cloud Functions** | HTTP and callable function authorization checks |
| **API Routes** | All Next.js `/api/*` endpoints |
| **Third-party webhook handlers** | Twilio webhook signature validation |

### 3.2 Out of Scope

- Denial of Service (DoS / DDoS) attacks of any kind
- Social engineering or phishing of KeyHub staff
- Physical security testing
- Firebase Authentication infrastructure (Google-managed)
- Vercel platform infrastructure (Vercel-managed)
- Third-party SaaS platforms (Twilio, VAPI, Google APIs) — test only the integration layer, not the platforms themselves
- Automated scanners run without prior notice that could impact production availability

---

## 4. Roles & Access Model

The application has the following roles. Test accounts will be provisioned for each.

| Role | Description | Key Access |
|------|-------------|------------|
| `owner` | Full system access | All modules, all data, all admin actions |
| `admin` | Operations & accounting | All modules, user approval, financials |
| `sales_rep` | 1099 sales contractor | Assigned leads, own job progress, own commissions |
| `contractor` | 1099 installer/tech | Assigned jobs, own availability, own earnings, contractor portal |
| `pm` | Project Manager | Assigned jobs, crew management |
| `subscriber` | External contractor | Subscriber portal, assigned leads, subscription management |
| `partner` | Partner company user | Partner portal, labor requests, service tickets |
| `pending` | Newly registered user | No app access — redirected to waiting page until admin approves |

### Authentication Flow

1. User signs up with email/password
2. Account is created in Firebase Auth and a Firestore `users` document is created with `status: "pending"`
3. Admin reviews and approves — sets `status: "active"` and assigns a `role`
4. User can now access the app according to their role

---

## 5. Test Accounts

The following accounts will be provisioned on production prior to testing. **Do not create your own accounts.**

| Role | Email | Password |
|------|-------|----------|
| `owner` | pentest-owner@keyhubcentral.com | *(provided separately)* |
| `admin` | pentest-admin@keyhubcentral.com | *(provided separately)* |
| `sales_rep` | pentest-salesrep@keyhubcentral.com | *(provided separately)* |
| `contractor` | pentest-contractor@keyhubcentral.com | *(provided separately)* |
| `pm` | pentest-pm@keyhubcentral.com | *(provided separately)* |
| `subscriber` | pentest-subscriber@keyhubcentral.com | *(provided separately)* |
| `partner` | pentest-partner@keyhubcentral.com | *(provided separately)* |
| `pending` | pentest-pending@keyhubcentral.com | *(provided separately)* |

> All test accounts are prefixed with `pentest-` so they can be identified and removed after testing.

---

## 6. Read-Only Firebase Console Access

You will be granted **read-only** access to the Firebase console for the project. This includes:

- **Firestore** — View collections, documents, and security rules
- **Storage** — View bucket structure and storage rules
- **Authentication** — View user list and custom claims
- **Functions** — View deployed function names and logs (no code access)

This is to help validate what the rules say vs. what they actually enforce. You are expected to also attempt to bypass rules from outside the console using the Firebase SDK and REST API directly.

---

## 7. Testing Checklist

### 7.1 Authentication & Authorization

- [ ] Can a `pending` user bypass the waiting page and access protected routes directly via URL?
- [ ] Can a `contractor` or `sales_rep` access `admin` or `owner`-only routes?
- [ ] Can a `partner` or `subscriber` access internal dashboard routes?
- [ ] Role escalation — can a user write `role: "owner"` or `status: "active"` to their own Firestore document?
- [ ] Session token tampering — can Firebase ID tokens be forged or replayed?
- [ ] Account enumeration — do login/signup errors reveal whether an email exists?
- [ ] Password reset abuse — are reset tokens single-use and time-limited?
- [ ] Suspended accounts — are they fully blocked or can they still make API calls with a valid token?

### 7.2 Firestore Security Rules

Test direct access via Firebase SDK and the Firestore REST API, authenticated as each role:

- [ ] Can any role read another user's `users/{uid}` document?
- [ ] Can a non-admin write `role`, `status`, `approvedAt`, or `approvedBy` fields?
- [ ] Can a `contractor` read the `invoices` collection for invoices that don't belong to them?
- [ ] Can a `sales_rep` read or write jobs they are not assigned to?
- [ ] Can a `subscriber` access `campaigns`, `leads` (unassigned), or `financials` collections?
- [ ] Can a `partner` access KR jobs, KTS contractors, or internal financials?
- [ ] Can an unauthenticated user read any collection beyond public lead creation?
- [ ] Can a contractor modify their own `rating` or `status` field?
- [ ] Can a crew member update job fields beyond `photos` and `updatedAt`?
- [ ] Can `notifications` be created by a client (should be Cloud Functions only)?

### 7.3 Firebase Storage

- [ ] Can an unauthenticated user access contractor W-9s at `/contractors/{uid}/documents/`?
- [ ] Can contractor A access contractor B's documents by guessing the UID path?
- [ ] Can job photos be accessed without authentication?
- [ ] File upload abuse — can a malicious file type (SVG with script, polyglot) be uploaded and served?

### 7.4 API Routes & Cloud Functions

- [ ] Are all `/api/*` routes protected — do they return 401 for unauthenticated requests?
- [ ] IDOR on job/lead/invoice/contractor endpoints — can records be accessed by guessing document IDs?
- [ ] Can a `sales_rep` hit an admin-only Cloud Function directly?
- [ ] Mass assignment — can extra fields be injected into Firestore writes via API?
- [ ] Are Cloud Functions (HTTP-triggered) validating Firebase Auth tokens?

### 7.5 Contractor Portal Isolation

- [ ] Can a contractor portal user access any `/dashboard` or internal routes?
- [ ] Can the auto-created contractor record be manipulated via the portal to escalate access?
- [ ] Stored XSS — are profile fields (skills, bio, name) sanitized before rendering?

### 7.6 Twilio / SMS Integration

- [ ] Are inbound Twilio webhooks validating the `X-Twilio-Signature` header?
- [ ] Can the webhook endpoint be triggered by an unauthenticated third party to inject messages?
- [ ] Is PII (phone numbers, names) logged in plaintext in Cloud Function logs?

### 7.7 Frontend / Next.js

- [ ] XSS in rendered user-supplied content (lead names, job notes, contractor bios)
- [ ] Open redirect — can the post-login redirect parameter be pointed to an external URL?
- [ ] Are sensitive values (Firebase config, API keys beyond public config) exposed in `__NEXT_DATA__` or JS bundles?
- [ ] CSRF — are state-changing actions protected?
- [ ] Are security headers present? (CSP, HSTS, X-Frame-Options, X-Content-Type-Options)

### 7.8 Lead Capture Forms (Public)

- [ ] Can the public lead form be abused to spam/flood the `leads` collection?
- [ ] Is there rate limiting on form submission?
- [ ] Can a lead be created with a forged `source` field to bypass business logic?

### 7.9 Dependency & Infrastructure

- [ ] Run `npm audit` — report any high/critical CVEs in dependencies
- [ ] Check Vercel preview deployments — do they connect to the same production Firebase project (data leakage risk)?
- [ ] Check `vercel.json` rewrites/redirects for auth bypass opportunities

---

## 8. Rules of Engagement

1. **No destructive actions** — do not delete, corrupt, or modify real data. Test accounts and synthetic data only.
2. **No DoS** — do not run load tests, fuzzing tools, or scanners at a rate that could degrade service for real users.
3. **No exfiltration** — do not download or retain real user PII, financial data, or contractor documents beyond what is needed to document a finding.
4. **Production environment** — you are testing against production. Real users may be active. Be mindful of timing (prefer off-hours for any higher-volume testing).
5. **No lateral movement** — scope is limited to this application. Do not attempt to pivot to Firebase infrastructure, Vercel infrastructure, or Google Cloud.
6. **Stop and report immediately** if you discover access to real sensitive data (SSNs, bank accounts, W-9s of actual contractors) — do not go further without confirmation.

---

## 9. Reporting

### Severity Levels

| Severity | Description | Example |
|----------|-------------|---------|
| **Critical** | Immediate data breach or full account takeover risk | Unauthenticated access to all contractor W-9s |
| **High** | Significant privilege escalation or data exposure | `contractor` can read all jobs/financials |
| **Medium** | Limited data exposure or requires chained exploit | Stored XSS in contractor profile |
| **Low** | Defense-in-depth gap, low exploitability | Missing security header |
| **Informational** | Best practice recommendation | Dependency with known low-severity CVE |

### Report Format (per finding)

```
Title:
Severity:
Affected Component:
Description:
Steps to Reproduce:
Impact:
Recommendation:
Evidence (screenshots/logs):
```

### Delivery

- Deliver final report as PDF or Markdown
- Submit to: aaron@innovativeaiconsulting.com
- Include all findings regardless of severity

---

## 10. Contact

**Primary Contact:** Aaron Litherland
**Email:** aaron@innovativeaiconsulting.com
**Phone:** (812) 890.6303

For urgent findings (Critical severity), contact immediately via phone.
